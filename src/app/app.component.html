<div class="container main-container" [class.game-mode]="gameStarted">
  <h1 class="title">ğŸ“ Alfabeto Interativo</h1>
  
  @if (!gameStarted) {
    <!-- Tela inicial -->
    <div class="status-text">
      <p>Clique no botÃ£o <strong>Iniciar</strong> para comeÃ§ar a jogar!</p>
      <small class="text-muted">ğŸ“Œ Dica: Use Chrome ou Edge para melhor reconhecimento de voz</small>
    </div>

    <div class="row g-3 mb-4">
      @for (letter of alphabet; track letter.id) {
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
          <div 
            class="card card-letter"
            [ngClass]="{
              'hidden': letter.state === 'hidden',
              'correct': letter.state === 'correct'
            }"
            [style.background]="getCardColor(letter)"
            (click)="speakLetter(letter.letter)">
            <div class="card-body letter-forms">
              <div class="letter-form letter-uppercase-print">{{ letter.letter }}</div>
              <div class="letter-form letter-lowercase-print">{{ letter.letter }}</div>
              <div class="letter-form letter-uppercase-cursive">{{ letter.letter }}</div>
              <div class="letter-form letter-lowercase-cursive">{{ letter.letter }}</div>
            </div>
          </div>
        </div>
      }
    </div>

    <div class="text-center">
      <button class="btn btn-primary btn-custom btn-start" (click)="startGame()">
        ğŸš€ Iniciar
      </button>
    </div>
  }

  @if (gameStarted && currentLetter) {
    <!-- Modo jogo -->
    <div class="game-screen">
      <div class="current-letter-card">
        <div class="letter-forms">
          <div class="letter-form letter-uppercase-print">{{ currentLetter }}</div>
          <div class="letter-form letter-lowercase-print">{{ currentLetter }}</div>
          <div class="letter-form letter-uppercase-cursive">{{ currentLetter }}</div>
          <div class="letter-form letter-lowercase-cursive">{{ currentLetter }}</div>
        </div>
      </div>

      <div class="mic-container">
        <button 
          class="mic-button"
          [class.recording]="isRecording"
          (mousedown)="startRecording()"
          (mouseup)="stopRecording()"
          (touchstart)="startRecording()"
          (touchend)="stopRecording()">
          ğŸ¤
        </button>
        @if (feedback !== 'none') {
          <div class="feedback-badge" [ngClass]="feedback">
            {{ feedback === 'correct' ? 'âœ“' : 'âœ—' }}
          </div>
        }
      </div>
    </div>

    <div class="game-actions">
      <button class="btn btn-secondary btn-small" (click)="stopGame()">
        â¸ï¸ Parar
      </button>
    </div>
  }

  @if (gameStarted && showReveal && revealedLetter) {
    <!-- Efeito de revelaÃ§Ã£o na tela inicial -->
    <div class="status-text">
      <p>ğŸ‰ ParabÃ©ns! VocÃª acertou!</p>
    </div>

    <div class="row g-3 mb-4">
      @for (letter of alphabet; track letter.id) {
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
          <div 
            class="card card-letter"
            [ngClass]="{
              'hidden': letter.state === 'hidden',
              'correct': letter.state === 'correct',
              'revealing': revealedLetter === letter.letter && letter.state === 'correct'
            }"
            [style.background]="getCardColor(letter)">
            <div class="card-body letter-forms">
              <div class="letter-form letter-uppercase-print">{{ letter.letter }}</div>
              <div class="letter-form letter-lowercase-print">{{ letter.letter }}</div>
              <div class="letter-form letter-uppercase-cursive">{{ letter.letter }}</div>
              <div class="letter-form letter-lowercase-cursive">{{ letter.letter }}</div>
            </div>
          </div>
        </div>
      }
    </div>
  }

  @if (gameStarted && !currentLetter && !showReveal) {
    <!-- ParabÃ©ns -->
    <div class="congratulations">
      <h2>ğŸ‰ ParabÃ©ns! VocÃª completou todas as letras!</h2>
      <button class="btn btn-success btn-custom" (click)="resetGame()">
        ğŸ”„ Jogar Novamente
      </button>
    </div>
  }
</div>
